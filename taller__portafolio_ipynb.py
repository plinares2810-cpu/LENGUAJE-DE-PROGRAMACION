# -*- coding: utf-8 -*-
"""Taller_ Portafolio_ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1MCTh5zn_wm2wAmgJEsgi1WGMy8tN-YZQ

# 游닂 Taller Evaluativo (20%) - An치lisis de Portafolio
### Curso: Ingenier칤a Financiera / Programaci칩n  
### Herramienta: Google Colab  

1.   Elemento de la lista
2.   Elemento de la lista


---
### 游꿢 Objetivo
Este taller busca que comprendas qu칠 es un an치lisis de portafolio, c칩mo se calculan y analizan sus m칠tricas (rentabilidad, riesgo y correlaci칩n), y c칩mo se interpreta el resultado para tomar decisiones de inversi칩n.

游녤 **Importante:** No basta con ejecutar el c칩digo. Debes **completar los espacios en blanco**, responder las **preguntas de investigaci칩n** y redactar un **an치lisis final**.

## 1. Importaci칩n de librer칤as
Primero, importa las librer칤as necesarias para trabajar con datos financieros.
"""

# COMPLETAR: importa las librerias necesarias (yfinance, pandas, numpy, matplotlib, seaborn)
# Ejemplo: import yfinance as yf

# COMPLETAR AQUI

import yfinance as yf
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

"""## 2. Descarga de datos

*   Elemento de la lista
*   Elemento de la lista


Usa `yfinance` para descargar los precios de **Google (GOOG)**, **Amazon (AMZN)** y **Microsoft (MSFT)** durante los 칰ltimos 3 a침os. Utiliza la columna `Adj Close`.

游댍 **Pregunta:** 쯇or qu칠 es m치s adecuado usar `Adj Close` que `Close` para un an치lisis financiero?
"""

# COMPLETAR: descarga los precios de las acciones usando yf.download

acciones = ["GOOG", "AMZN", "MSFT"]
datos = yf.download(tickers=acciones)["Close"]
datos.head()

datos.tail() # Veo los ultimos 5 datos

"""## 3. Visualizaci칩n de precios
Grafica en una misma figura la evoluci칩n de los precios de cierre ajustados de las tres acciones.

游댍 **Pregunta:** 쮺u치l de las tres acciones muestra mayor crecimiento en estos 3 a침os?
"""

# COMPLETAR: grafica de las tres series de precios en una sola gr치fica

plt.figure(figsize=(10, 6))
plt.plot(datos["GOOG"], label="GOOG")
plt.plot(datos["AMZN"], label="AMZN")
plt.plot(datos["MSFT"], label="MSFT")
plt.legend()
plt.show()

import plotly.express as px

datos.px
plt.show()

"""## 4. Rentabilidades
Calcula las **rentabilidades logar칤tmicas diarias** y graf칤calas.

游댍 **Pregunta:** 쯈u칠 diferencias encuentras entre observar precios y observar rentabilidades?
"""

# COMPLETAR: calcula los rendimientos logar칤tmicos

rendimientos = np.log(datos / datos.shift(1))
rendimientos = rendimientos.dropna()
(rendimientos.head())

# Graficar
# COMPLETAR AQU칈

# COMPLETAR: graficar los rendimientos logaritmicos diarios

plt.figure(figsize=(11, 6))

for c in rendimientos.columns:
    plt.plot(rendimientos.index, rendimientos[c], label=c)

plt.title("Rentabilidades logartitmicas diarias")
plt.xlabel("fecha")
plt.ylabel("retorno diario")
plt.legend()
plt.show()

"""### An치lisis

- Cuando observamos **precios**, vemos una tendencia general, es decir, crecen o decrecen en el tiempo.
- En cambio, al observar **rentabilidades**, vemos la variacion diaria (subidas y bajadas alrededor de 0).

## 5. Medidas estad칤sticas
Calcula la **rentabilidad promedio** y la **volatilidad (desviaci칩n est치ndar)** de cada acci칩n.

游댍 **Pregunta:** 쮺u치l acci칩n es m치s riesgosa? 쮺u치l ofrece mayor retorno?
"""

# COMPLETAR: calcula media y desviaci칩n est치ndar

media = rendimientos.mean()
volatilidad = volatilidad = rendimientos.std()

print("Rentabilidad promedio diaria:")
print(media)
print("\nVolatilidad diaria:")
print(volatilidad)

"""### An치lisis Punto 5

- La acci칩n con mayor **rentabilidad promedio** es la m치s rentable.  
- La acci칩n con mayor **volatilidad** es la m치s riesgosa.  
- Generalmente, a mayor rentabilidad esperada tambi칠n se asume un mayor riesgo.

## 6. Correlaci칩n entre activos
Calcula y grafica la matriz de correlaci칩n entre las acciones.

游댍 **Pregunta:** 쯈u칠 significa que dos acciones tengan una correlaci칩n cercana a 1? 쯏 cercana a 0 o negativa?
"""

# COMPLETAR: calcula la correlaci칩n y haz un mapa de calor con seaborn

correlacion = rendimientos.corr()

sns.heatmap(correlacion, annot=True, cmap="coolwarm")
plt.title("matriz de correlacion entre acciones")
plt.show()

print("Matriz de correlaci칩n:")
print(correlacion)

"""### An치lisis Punto 6

- Una correlaci칩n cercana a **1** significa que dos acciones tienden a moverse en la misma direcci칩n.  
- Una correlaci칩n cercana a **0** indica que no existe una relaci칩n clara entre ellas.  
- Una correlaci칩n **negativa** significa que los activos se mueven en direcciones opuestas, lo cual es 칰til para diversificaci칩n.  

En este caso, observamos que:
- El par m치s correlacionado es ____ (ejemplo: GOOG y MSFT).  
- El par menos correlacionado es ____ (ejemplo: AMZN y MSFT).  

Esto muestra que las acciones tienen una relaci칩n positiva, aunque no perfecta, lo que permite cierta reducci칩n de riesgo al diversificar.
"""



"""## 7. Portafolio simulado
Sup칩n un portafolio con la siguiente distribuci칩n:
- 40% Google
- 30% Amazon
- 30% Microsoft

Calcula el **retorno esperado** y la **volatilidad del portafolio**.

游댍 **Preguntas:**
1. 쮺칩mo interpretas el retorno esperado del portafolio?
2. 쯈u칠 efecto tuvo la diversificaci칩n sobre la volatilidad respecto a invertir en una sola acci칩n?
"""

# COMPLETAR: c치lculo del retorno y riesgo del portafolio

pesos = np.array([0.4, 0.3, 0.3])

retorno_portafolio = np.dot(pesos, rendimientos.mean())
covarianza = rendimientos.cov()
vol_portafolio = np.sqrt(np.dot(pesos.T, np.dot(covarianza, pesos)))

print("Retorno esperado del portafolio (diario):", retorno_portafolio)
print("Volatilidad del portafolio (diaria):", vol_portafolio)

"""### An치lisis Punto 7

- El **retorno esperado del portafolio** es el promedio ponderado de las rentabilidades de las tres acciones seg칰n los pesos definidos.  
- La **volatilidad del portafolio** representa el riesgo total de la inversi칩n considerando tanto el riesgo individual de cada acci칩n como sus correlaciones.  
- En general, la diversificaci칩n permite que la volatilidad del portafolio sea **menor** que la de la acci칩n m치s riesgosa de manera individual.  
- Esto significa que repartir la inversi칩n entre varias acciones ayuda a reducir el riesgo sin sacrificar demasiado retorno.

九꽲잺 8. Conclusi칩n final
Redacta un an치lisis completo del portafolio respondiendo:

쯈u칠 acci칩n fue m치s rentable y cu치l m치s riesgosa?
쯈u칠 tan correlacionadas est치n las acciones?
쯈u칠 aport칩 la diversificaci칩n al portafolio?
Si fueras un inversionista, 쯜nvertir칤as en este portafolio? Justifica tu respuesta.

### Conclusi칩n Final

- **Acci칩n m치s rentable:** fue aquella con mayor rentabilidad promedio (seg칰n los resultados del Punto 5).  
- **Acci칩n m치s riesgosa:** fue la que present칩 la mayor volatilidad (seg칰n el Punto 5).  
- **Correlaci칩n entre acciones:** en el Punto 6 vimos que las correlaciones fueron positivas, lo que significa que las acciones tienden a moverse en la misma direcci칩n, aunque no perfectamente.  
- **Diversificaci칩n:** gracias a la combinaci칩n (40% GOOG, 30% AMZN y 30% MSFT), la volatilidad del portafolio fue menor que la de la acci칩n m치s riesgosa por separado. Esto muestra que la diversificaci칩n reduce el riesgo sin perder demasiado retorno.  
- **Decisi칩n de inversi칩n:** s칤 considerar칤a invertir en este portafolio, ya que ofrece un balance entre rentabilidad y riesgo. Sin embargo, como inversionista tambi칠n tendr칤a en cuenta factores externos como la situaci칩n del mercado, noticias sobre cada empresa y mi tolerancia personal al riesgo.
"""